webpackJsonp([10],{"2mTW":function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=e.contactCount,n=e.isInContactRequestsView,a=e.onClick;if(!t&&!n)return null;var r=void 0;return r=t>X?B.a._("1000+ contact requests","messaging"):t>=K&&t<=X?B.a._("100+ contact requests","messaging"):L.h(B.a.ngettext("{{ contactCount }} contact request","{{ contactCount }} contact requests",t),{contactCount:""+t}),M.a.createElement("div",{className:"Module ContactRequestsCount"},M.a.createElement(G.a,{className:F()({contactRequestView:n},"isBrioFlat","contactRequestsCount","btn"),hasIcon:n,hasText:!0,onClick:a,text:r,type:"borderless"}))}function s(e){var t=e.contactRequests,n=e.handleCancelViewContactRequests;return t?M.a.createElement("div",{className:"Module ContactRequestsCount"},M.a.createElement(Z,{contactCount:t.length,isInContactRequestsView:!0,onClick:n}),M.a.createElement(A.b,{padding:2},M.a.createElement(A.G,{size:"sm"},B.a._("These messages appear from people outside of your networks.","contact requests disclaimer"))),t.map(function(e,t){return M.a.createElement("div",{key:e.id},0!==t?J:null,M.a.createElement(V,e))})):null}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e){var t=e.viewer;return{viewerId:t.isAuth?t.id:null}}function d(e){var t=e.contactItem,n=e.currentUserID,a=e.conversationItem,r=e.handleContactWrapperClick,o=e.isSelected,i=e.isUser,s=["selectionIndicator","contactCircleRep","selectionIndicator"];return M.a.createElement("a",{className:"conversationContactContainer",key:a.id,onClick:function e(){return r(i,t)},onKeyDown:function e(){},role:"button",tabIndex:0},me(n,a),o?M.a.createElement("div",{className:s.join(" ")},fe):null)}function m(e){var t=e.tokenizedItems;return M.a.createElement("div",{className:"reactTokenizedInputContainer",style:{zIndex:1e3}},M.a.createElement("div",{className:"tokenContainer"},t.map(function(e,t){return M.a.createElement("div",{className:"tokenItem",key:t},e.full_name?M.a.createElement($.a,{size:"small",users:[e]}):M.a.createElement($.a,{emails:[e],size:"small"}))})),ve)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function b(e){var t=e.boardInvites;return t?M.a.createElement("div",null,t.map(function(e){return M.a.createElement(Ce,{boardInviteItem:e,key:e.id})})):null}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var D=n("OVW8"),M=n.n(D),P=n("DUIN"),L=n("5tOk"),B=n("W/Cr"),W=n("IaRT"),U=n.n(W),H=n("ZtCB"),q=n.n(H),A=n("gEaE"),V=function(e){function t(){var n,o,i;a(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=o=r(this,e.call.apply(e,[this].concat(c))),o.state={contactRequestCompleted:!1,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1},o.handleInviteAcceptResponse=function(){o.setState({isAcceptButtonLoading:!0,isIgnoreButtonLoading:!1}),q.a.create("ContactRequestAcceptResource",{contact_request:o.props}).callUpdate().then(function(){o.setState({contactRequestCompleted:!0,isAcceptButtonLoading:!1})})},o.handleInviteDeclineResponse=function(){o.setState({isAcceptButtonLoading:!1,isIgnoreButtonLoading:!0}),q.a.create("ContactRequestIgnoreResource",{contact_request:o.props}).callDelete().then(function(){o.setState({contactRequestCompleted:!0,isIgnoreButtonLoading:!1})})},i=n,r(o,i)}return o(t,e),t.prototype.renderRequestText=function e(t,n,a){if(t){var r=t.name,o=t.url;return L.h(B.a._('<a href="/{{ senderUsername }}/">{{ senderName }}</a> invited you to collaborate on <a href="{{ boardUrl }}">{{ boardName }}</a>'),{boardName:r,boardUrl:o,senderName:n,senderUsername:a})}return L.h(B.a._('<a href="/{{ senderUsername }}/">{{ senderName }}</a> wants to send a message to you'),{senderName:n,senderUsername:a})},t.prototype.render=function e(){var t=this.state,n=t.contactRequestCompleted,a=t.isAcceptButtonLoading,r=t.isIgnoreButtonLoading;if(n)return null;var o=this.props,i=o.board,s=o.sender,c=s.image_large_url,l=s.full_name,u=s.username;return M.a.createElement(A.b,{paddingX:2,paddingY:4,xs:{display:"flex"}},M.a.createElement(A.b,{height:50,width:50,flex:"none"},M.a.createElement(A.s,{href:"/"+u+"/"},M.a.createElement(A.a,{name:u,src:c}))),M.a.createElement(A.b,{paddingX:3},M.a.createElement(A.b,{marginBottom:3},M.a.createElement(A.G,null,M.a.createElement("span",{dangerouslySetInnerHTML:{__html:this.renderRequestText(i,l,u)}}))),M.a.createElement(A.b,{xs:{display:"flex"},marginLeft:-1,marginRight:-1},M.a.createElement(A.b,{paddingX:1,flex:"grow"},M.a.createElement(A.c,{disabled:r,onClick:this.handleInviteDeclineResponse,size:"sm",text:B.a._("Ignore","ignore contact request")})),M.a.createElement(A.b,{paddingX:1,flex:"grow"},M.a.createElement(A.c,{color:"red",disabled:a,onClick:this.handleInviteAcceptResponse,size:"sm",text:B.a._("Accept","accept contact request")})))))},t}(D.Component),z=n("GGB8"),F=n.n(z),G=n("nM9s"),Y=n("JKYN"),K=100,X=1e3,Z=Object(Y.b)({name:"ContactRequestsCountGetResource",key:"contactCount"},{allowStale:!1})(i),J=M.a.createElement(A.i,null),Q=Object(Y.b)({name:"ContactRequestsResource",key:"contactRequests"},{allowStale:!1})(s),$=n("NYeZ"),ee=n("dnEF"),te=n("tmfO"),ne=n("Kqaz"),ae=n("/S3G"),re=n("MQ2h"),oe=n.n(re),ie=n("Vfgg"),se=n("dCTv"),ce=n("fvzG"),le=50,ue=M.a.createElement("span",{className:"conversationUnreadMark"}),pe=function(e){function t(){var n,a,r;c(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=l(this,e.call.apply(e,[this].concat(i))),a.state={isHidden:!1,unread:a.props.data.unread||0},a.handleHideConversation=function(e){e.stopPropagation();var t=a.props.data.id;q.a.create("ConversationResource",{conversation_id:t}).callDelete({showError:!1}),a.removeConversationChatHead(t),a.setState({isHidden:!0}),a.logConversationItemHide(t)},a.handleConversationItemClick=function(){var e=a.props.data;a.setState({unread:0}),e.board||a.showConversationChatHead(e),a.logConversationItemClick()},a.logConversationItemClick=function(){(0,a.props.contextLog)(101,{component:54,element:277})},a.logConversationItemHide=function(e){(0,a.props.contextLog)(182,{component:54,element:277,conversation_id:e})},r=n,l(a,r)}return u(t,e),t.prototype.showConversationChatHead=function e(t){var n=this.props.dispatch,a=t.id;n(Object(ce.e)(a)),n(Object(ce.d)(a)),n(ae.a)},t.prototype.removeConversationChatHead=function e(t){var n=this.props.dispatch;n(Object(ce.c)(t)),n(Object(ce.a)(t))},t.prototype.renderConversationsTitleNames=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(function(e,t){return M.a.createElement(te.b,{to:"/"+e.username+"/",key:t},e.first_name)}).concat(t.map(function(e,t){return M.a.createElement("span",{key:t},e)}));return M.a.createElement("div",{className:"membersTitleNames"},n.map(function(e,t){var a=B.a._(", ","comma separating conversation member names");return M.a.createElement("span",{key:t},e,t===n.length-1?"":M.a.createElement("span",null,a))}))},t.prototype.renderConversationsTitleView=function e(t,n,a,r){var o=this.props.viewerId,i=r.filter(function(e){return e.id!==o});return M.a.createElement("h1",{className:"conversationTitleContainer"},n||this.renderConversationsTitleNames(a,i))},t.prototype.renderLastMessage=function e(t){var n=t.board,a=t.created_at,r=t.pin,o=t.sender,i=t.text,s=t.user,c=i;if(!c){var l=o.first_name;r?c=L.h(B.a._("{{ senderName }} sent a Pin","messaging"),{senderName:l}):n?c=L.h(B.a._("{{ senderName }} sent a board","messaging"),{senderName:l}):s&&(c=L.h(B.a._("{{ senderName }} sent a user profile","messaging"),{senderName:l}))}return c=Object(ie.b)(c||"",50),M.a.createElement("div",null,M.a.createElement("div",{className:"lastMessageContent"},c),M.a.createElement("div",{className:"lastMessageTimestamp"},B.a.getHumanizedTimesince(a)))},t.prototype.renderItemContent=function e(){var t=this.state.isHidden,n=this.props.data,a=n.board,r=n.emails,o=n.last_message,i=n.name,s=n.users,c=r||[];return M.a.createElement("div",{className:F()("ConversationListItemReact",{conversationHidden:t})},M.a.createElement("div",{className:"conversationRepContainer"},M.a.createElement($.a,{board:a,emails:c,users:s})),M.a.createElement("div",{className:"conversationContentContainer"},this.renderConversationsTitleView(a,i,c,s),o?this.renderLastMessage(o):null),this.state.unread>0?ue:null,M.a.createElement(G.a,{className:"conversationCloseButton",hasText:!0,onClick:this.handleHideConversation,text:B.a._("×","close button"),type:"borderless"}))},t.prototype.render=function e(){var t=this.props.data,n=t.board;return t.users.length?n?M.a.createElement(te.b,{onClick:this.handleConversationItemClick,to:n.url},this.renderItemContent()):M.a.createElement("div",{onClick:this.handleConversationItemClick,role:"button"},this.renderItemContent()):null},t}(D.Component);pe.contextTypes={userAgent:U.a.shape({isMobile:U.a.bool.isRequired}).isRequired};var de=Object(re.compose)(Object(P.connect)(p),ne.a,Object(se.b)())(pe),me=function e(t,n){var a=n.emails,r=n.users,o=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t&&0!==t.length){var n=t[0];return M.a.createElement("div",{className:"contactWrapper"},M.a.createElement($.a,{emails:[n],size:"small"}),M.a.createElement("div",{className:"contactTextInfo"},M.a.createElement("span",{className:"contactName"},n),M.a.createElement("span",{className:"contactDescription"},B.a._("Email friend","on selected contact list"))))}},i=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=n[0].id===t?n[1]:n[0],r=a.full_name;return M.a.createElement("div",{className:"contactWrapper"},M.a.createElement($.a,{size:"small",users:[a]}),M.a.createElement("div",{className:"contactTextInfo"},M.a.createElement("span",{className:"contactName"},r),M.a.createElement("span",{className:"contactDescription"},B.a._("On Pinterest","info about a contact"))))};return M.a.createElement("div",null,a&&a.length>0?o(a):i(r))},fe=M.a.createElement("em",null);d.defaultProps={isSelected:!1};var he=n("tZWC"),ve=M.a.createElement("div",{className:"textFieldContainer"}),ge=8,ye=2,Ee=function(e){function t(){var n,a,r;f(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=h(this,e.call.apply(e,[this].concat(i))),a.state={contactCounter:0,selectedEmails:{},selectedUsers:{},tokenizedItems:[],value:""},a.onHandleContactClick=function(e,t){var n=a.state,r=n.selectedEmails,o=n.selectedUsers,i=e?o:r,s=e?t.id:t,c=i[s];i[s]=!c,c?a.removeTokenItem(t):a.addTokenItem(t)},a.getSelectedEmails=function(){var e=a.state.selectedEmails;return Object.keys(e).filter(function(t){return e[t]})},a.getSelectedUsers=function(){var e=a.state.selectedUsers;return Object.keys(e).filter(function(t){return e[t]})},a.handleTypeaheadKeyDown=function(e){var t=a.state,n=t.contactCounter,r=t.selectedEmails,o=t.selectedUsers,i=t.tokenizedItems,s=t.value;if(e.keyCode===ge&&n&&!s){var c=i.pop(),l=!!c.id,u=c.id||c;(l?o:r)[u]=!1,a.setState({contactCounter:n-1,tokenizedItems:i})}},a.handleInviteItemClick=function(e,t){var n=a.state,r=n.selectedUsers,o=n.selectedEmails,i=e?r:o,s=t.id||t;i[s]||(i[s]=!0,a.addTokenItem(t))},a.handleSendMessage=function(){var e=a.getSelectedEmails(),t=a.getSelectedUsers(),n=a.props.dispatch;q.a.create("ConversationsResource",{user_ids:t,emails:e,text:null}).callCreate().then(function(e){var t=e&&e.resource_response.data.id;n(Object(ce.e)(t)),n(Object(ce.d)(t))})},a.addTokenItem=function(e){var t=a.state,n=t.contactCounter,r=t.tokenizedItems;a.setState({contactCounter:n+1,tokenizedItems:r.concat([e]),value:""})},a.removeTokenItem=function(e){var t=a.state,n=t.contactCounter,r=t.tokenizedItems;n-=1,e.id?(r=r.filter(function(t){return t.id!==e.id}),a.setState({contactCounter:n,tokenizedItems:r})):a.setState({contactCounter:n,tokenizedItems:(r||[]).filter(function(t){return t!==e})})},a.renderSendMessageButton=function(){return M.a.createElement(G.a,{className:"sendNewMessageButton",hasText:!0,onClick:a.handleSendMessage,showText:!0,text:B.a._("Next","open the new chat"),type:"borderless"})},a.renderCancelMessageButton=function(){var e=a.props.handleCancelNewMessageClick;return M.a.createElement(G.a,{className:"cancelNewMessageView cancelButton",hasText:!0,onClick:e,showText:!0,text:B.a._("Cancel","cancel new message view"),type:"borderless"})},r=n,h(a,r)}return v(t,e),t.prototype.getContactItem=function e(t,n,a){var r=t.emails,o=t.users;return a&&o?o[0].id===n?o[1]:o[0]:r[0]},t.prototype.render=function e(){var t=this,n=this.props,a=n.conversationItems,r=n.viewerId,o=this.state,i=o.contactCounter,s=o.selectedUsers,c=o.selectedEmails,l=o.value,u=new Set,p=a.map(function(e,n){var a=e.emails,o=e.users;a||(a=[]),o||(o=[]);var i=o.length+a.length;if(i>0&&i<=2){var l=0===a.length,p=t.getContactItem(e,r,l);if(p){var m=p.id||p;if(!u.has(m))return u.add(m),M.a.createElement(d,{className:"conversationContactContainer",contactItem:p,conversationItem:e,currentUserID:r,handleContactWrapperClick:t.onHandleContactClick,isSelected:s[m]||c[m],isUser:l,key:m+"-"+n})}}return null});return M.a.createElement("div",null,M.a.createElement(A.b,{display:"flex",justifyContent:"between",padding:3},M.a.createElement(A.G,{size:"sm",color:"gray"},B.a._("New message","conversations")),i>0?this.renderSendMessageButton():this.renderCancelMessageButton()),M.a.createElement(A.b,{color:"lightGray",display:"flex",padding:3},M.a.createElement(A.b,{display:"flex",alignItems:"center",marginRight:2},M.a.createElement(A.G,{size:"sm"},B.a._("To:","new message"))),M.a.createElement(A.b,{display:"flex",position:"relative",flex:"grow"},M.a.createElement(m,{tokenizedItems:this.state.tokenizedItems}),M.a.createElement(he.a,{changeOnTextHover:!1,className:"reactNewMessageTypeahead",onChange:function e(n){return t.setState({value:n})},onInviteItemClick:this.handleInviteItemClick,onKeyDown:this.handleTypeaheadKeyDown,showInputPlaceholder:!1,value:this.state.value}))),l?null:M.a.createElement("div",{className:"contactsContainer"},p))},t}(D.Component),be=function e(t){return{viewerId:t.viewer.id}},we=Object(re.compose)(Object(P.connect)(be))(Ee),Ce=function(e){function t(){var n,a,r;g(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=y(this,e.call.apply(e,[this].concat(i))),a.state={boardInviteAccepted:!1,boardInvitePending:!0,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1},a.handleInviteResponse=function(e){var t=a.props.boardInviteItem,n=t.board,r=void 0===n?{}:n,o=t.invited_user,i=void 0===o?{}:o;a.setState({isAcceptButtonLoading:e,isIgnoreButtonLoading:!e});var s={board_id:r.id,invited_user_id:i.id},c=q.a.create("BoardInviteResource",s);(e?c.callUpdate():c.callDelete()).then(function(){a.setState({boardInviteAccepted:e,boardInvitePending:!1,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1})})},r=n,y(a,r)}return E(t,e),t.prototype.getBoardRep=function e(t,n){return M.a.createElement("div",{className:"leftObjectWrapper boardRepWrapper"},M.a.createElement("div",{className:"Image Module boardMessageRep"},M.a.createElement("div",{className:"heightContainer"},M.a.createElement("img",{alt:t,src:n}))))},t.prototype.getBoardInfo=function e(t,n){return M.a.createElement("a",{href:n},M.a.createElement("div",{className:t},t))},t.prototype.getInviteeInfo=function e(t){var n=t.full_name;return M.a.createElement("div",{className:"inviterLine"},Object(L.h)(B.a._("{{ fullName }} invited you to this board"),{fullName:n}))},t.prototype.renderPendingLayout=function e(t,n){var a=this,r=t.image_thumbnail_url,o=t.name,i=t.url;return M.a.createElement("div",{className:"pending"},M.a.createElement("div",{className:"left"},this.getBoardRep(o,r),M.a.createElement("div",{className:"description"},this.getBoardInfo(o,i),this.getInviteeInfo(n))),M.a.createElement("div",{className:"actions"},M.a.createElement(G.a,{className:"remove",loading:this.state.isIgnoreButtonLoading,onClick:function e(){return a.handleInviteResponse(!1)},text:B.a._("Ignore","ignore board invite")}),M.a.createElement(G.a,{className:F()("primary","accept"),loading:this.state.isAcceptButtonLoading,onClick:function e(){return a.handleInviteResponse(!0)},text:B.a._("Accept","accept board invite")})))},t.prototype.renderCompletedLayout=function e(t){var n=t.image_thumbnail_url,a=t.name,r=t.url;return M.a.createElement("div",{className:"success displayed"},M.a.createElement("div",{className:"left"},this.getBoardRep(a,n),M.a.createElement("div",{className:"description"},this.getBoardInfo(a,r),M.a.createElement("div",{className:"inviterLine"},B.a._("You joined this board","board invites")))))},t.prototype.render=function e(){if(!this.state.boardInvitePending&&!this.state.boardInviteAccepted)return null;var t=this.props.boardInviteItem,n=t.board,a=t.invited_by_user;return M.a.createElement("div",{className:"BoardInvite Module news"},this.state.boardInvitePending?this.renderPendingLayout(n,a):this.renderCompletedLayout(n))},t}(D.Component),_e=Object(Y.b)({name:"BoardInvitesResource",key:"boardInvites",options:{current_user:!0,field_set_key:"news"}},{allowStale:!1})(b),Ie=n("nX0T"),Ne=500,Te="existingConversationsView",Oe="newMessageView",xe="contactRequestsView",ke=M.a.createElement("div",{className:"icon"}),Se=M.a.createElement("div",{className:"boardInvitesContainer"},M.a.createElement(_e,null)),je=function(e){function t(){var n,a,r;w(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=C(this,e.call.apply(e,[this].concat(i))),a.state={currentView:Te},a.handleCancelSecondaryView=function(){a.setState({currentView:Te})},a.handleNewMessageButtonClick=function(){a.setState({currentView:Oe}),a.logNewMessageButtonClick()},a.handleViewContactRequestsClick=function(){a.setState({currentView:xe})},a.handleScroll=function(){a.props.isFetching||(a._container&&a._container.scrollHeight-a._container.scrollTop-a._container.clientHeight)<Ne&&a.fetchMore()},a.logNewMessageButtonClick=function(){(0,a.props.contextLog)(101,{component:54,element:275})},r=n,C(a,r)}return _(t,e),t.prototype.componentDidMount=function e(){this.props.isFullAuth&&this._container.addEventListener("scroll",this.handleScroll)},t.prototype.componentWillUnmount=function e(){this._container.removeEventListener("scroll",this.handleScroll)},t.prototype.fetchMore=function e(){var t=this.props,n=t.isAtEnd,a=t.isFetching,r=t.fetchMoreData,o=t.isFullAuth;!a&&o&&(n?this._container.removeEventListener("scroll",this.handleScroll):r())},t.prototype.renderNewMessageView=function e(){var t=this.props.conversations,n=void 0===t?[]:t;return M.a.createElement("div",{className:"newMessageContainer"},M.a.createElement(we,{conversationItems:n,handleCancelNewMessageClick:this.handleCancelSecondaryView}))},t.prototype.renderContactRequestsView=function e(){return M.a.createElement("div",{className:"contactRequestsContainer"},M.a.createElement(Q,{handleCancelViewContactRequests:this.handleCancelSecondaryView}))},t.prototype.renderEmptyMessagesNewMessageUpsell=function e(){return M.a.createElement("div",{className:"EmptyConversations Module"},ke,M.a.createElement("div",{className:"intro"},M.a.createElement("div",null,B.a._("Send messages to your friends!")),M.a.createElement("div",null,B.a._("Plan projects, swap ideas and share your best discoveries."))))},t.prototype.renderExistingConversationsView=function e(){var t=this.props,n=t.conversations,a=void 0===n?[]:n,r=t.isAtEnd;return M.a.createElement("div",{className:"existingConversationsContainer"},M.a.createElement("div",{className:"newMessageButtonContainer"},M.a.createElement(G.a,{className:"createConversationTab",hasIcon:!0,onClick:this.handleNewMessageButtonClick,text:B.a._("New message"),type:"borderless"})),M.a.createElement("div",{className:"viewContactRequestsButtonContainer"},M.a.createElement(Z,{onClick:this.handleViewContactRequestsClick})),M.a.createElement("div",{className:"existingConversationItemsWrapper"},Se,M.a.createElement("ul",{className:"conversationItems"},0===a.length&&r?this.renderEmptyMessagesNewMessageUpsell():a.map(function(e){return M.a.createElement("li",{className:"conversationItemWrapper",key:e.id},M.a.createElement(de,{data:e}))}))))},t.prototype.renderMessageView=function e(){switch(this.state.currentView){case Te:return this.renderExistingConversationsView();case Oe:return this.renderNewMessageView();case xe:return this.renderContactRequestsView()}},t.prototype.render=function e(){var t=this;return M.a.createElement(Ie.a,{view:42,viewParameter:203},M.a.createElement("div",{className:"conversationPanel",ref:function e(n){t._container=n}},this.renderMessageView()))},t}(D.Component),Re=function e(t){return{isFullAuth:t.viewer.isAuth&&!t.viewer.isLimitedLogin}},De=Object(re.compose)(Object(P.connect)(Re),ne.a,Object(Y.b)({name:"ConversationsResource",key:"conversations"}))(je),Me=n("SnoN"),Pe={ONE:1,TWO:2,END:3},Le=function(e){function t(){var n,a,r;I(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=N(this,e.call.apply(e,[this].concat(i))),a.state={educationStep:Pe.ONE},a.toStepTwo=function(){a.setState({educationStep:Pe.TWO})},a.dismissEducation=function(){var e=a.props.handleDismiss;a.setState({educationStep:Pe.END}),e()},r=n,N(a,r)}return T(t,e),t.prototype.componentDidMount=function e(){var t=this,n=this.props.stepDelay;this.educationStepTimer=setTimeout(function(){t.state.educationStep<Pe.TWO&&t.setState({educationStep:Pe.TWO})},n)},t.prototype.componentWillUnmount=function e(){clearTimeout(this.educationStepTimer)},t.prototype.renderPill=function e(t,n,a){return M.a.createElement("button",{onClick:a,className:F()("educationPill","slideIn",{fadeOut:n})},M.a.createElement("div",{className:"message"},t))},t.prototype.render=function e(){var t=this.state.educationStep,n=this.props,a=n.titleText,r=n.titleText2,o=this.renderPill(a,t===Pe.TWO,this.toStepTwo),i=this.renderPill(r,t===Pe.END,this.dismissEducation);return M.a.createElement("div",{className:"newsHubEducation"},M.a.createElement("div",{className:"educationStep stepOne"},(t===Pe.ONE||t===Pe.TWO)&&o),M.a.createElement("div",{className:"educationStep stepTwo bottom"},(t===Pe.TWO||t===Pe.END)&&i))},t}(D.Component),Be=n("zFaW"),We=n("7Dxt"),Ue=Object(We.a)(Be.a),He=n("mnfW"),qe=n("RvAN"),Ae=n("mHth"),Ve=n("YZkw"),ze=4,Fe=864e5,Ge=function(e){function t(n){O(this,t);var a=x(this,e.call(this,n));return a.state={shouldEducate:!1},a.onDataFetched=function(e){a.props.experience&&e>ze&&!a.state.shouldEducate&&a.setState({shouldEducate:!0})},a.handleItemClick=function(){a.handleComplete(),a.props.handleItemClick()},a.handleComplete=function(){var e=a.props,t=e.experienceClient,n=e.experience;n&&t.completeExperience(n.placement_id,n.experience_id)},a.handleDismiss=function(){var e=a.props,t=e.experienceClient,n=e.experience;n&&t.dismissExperience(n.placement_id,n.experience_id)},a.renderItem=function(e,t){var n={impressionAuxFields:{displayMode:e.encoded_display_mode,newsType:e.news_type},impressionType:"News",loggingId:e.id,slotIndex:t,viewParameter:3081,viewType:107};return M.a.createElement("li",{className:"newsHubItemWrapper",key:t},a.renderDate(e.last_updated_at,t),M.a.createElement(Ue,Object.assign({contentItemCount:e.content_item_count,contentItems:e.content_items,contentText:e.content_text,displayMode:e.encoded_display_mode,handleClick:a.handleItemClick,headerIconImageUrl:e.header_icon_image_url,headerIconObjects:e.header_icon_objects,headerText:e.header_text,id:e.id,lastUpdatedAt:e.last_updated_at,overrideClickUrl:e.override_click_url,subHeaderText:e.sub_header_text,siteType:a.props.siteType,textMapping:e.text_mapping,type:e.news_type,unread:e.unread},n)))},a.renderEmptyState=function(){return M.a.createElement(A.b,{height:400},M.a.createElement(A.b,{display:"flex",justifyContent:"center",color:"darkGray",shape:"pill",paddingY:5,margin:5},M.a.createElement(A.g,{xs:10},M.a.createElement(A.G,{bold:!0,color:"white",size:"lg"},B.a._("New! Discover ideas from your friends, followers and people who love your Pins!")))))},a.currentDay=null,a.today=new Date,a.today.setHours(0,0,0,0),a}return k(t,e),t.prototype.getChildContext=function e(){return{preloadingSupported:!0}},t.prototype.componentDidMount=function e(){var t=this.props,n=t.experience,a=t.experienceClient;n&&a.viewExperience(n.placement_id,n.experience_id),this.logPanelImpression()},t.prototype.shouldComponentUpdate=function e(t,n){if(this.state.shouldEducate===n.shouldEducate){var a=this.props.experience,r=t.experience;return(a||{}).id!==(r||{}).id}return!0},t.prototype.getEducation=function e(){var t=this.props.experience;if(this.state.shouldEducate&&t){var n=t.display_data,a=n.step_delay,r=n.title_text,o=n.title_text_2;return M.a.createElement(Le,{handleDismiss:this.handleDismiss,stepDelay:a,titleText:r,titleText2:o})}return null},t.prototype.logPanelImpression=function e(){var t=this.props.contextLog,n=Me.a.getInstance(),a=n.getViewFromContext();t(13,{view:107,viewParameter:3081}),n.addViewToContext(a)},t.prototype.renderDate=function e(t,n){var a=new Date(t);if(a.setHours(0,0,0,0),0!==n&&null!==this.currentDay&&void 0!==this.currentDay){var r=this.currentDay;if(a.getTime()===r.getTime())return null}this.currentDay=a;var o=void 0;return o=a.getTime()===this.today.getTime()?B.a._("Today"):a.getTime()===new Date(this.today-864e5).getTime()?B.a._("Yesterday"):a&&a>=new Date(this.today-5184e5)?B.a.getHumanizedTimesince(a.toString()):He.b.formatDate(this.props.locale,a,He.b.DateFormatType.MONTH_DAY,!1),M.a.createElement("div",{className:"newsHubItemDate"},M.a.createElement(A.G,{bold:!0,size:"xl"},o))},t.prototype.render=function e(){return M.a.createElement(Ie.a,{view:107,viewParameter:3081},M.a.createElement("div",null,this.getEducation(),M.a.createElement(qe.a,{className:"newsHubPanel",onDataFetched:this.onDataFetched,renderEmptyState:this.renderEmptyState,renderItem:this.renderItem,resourceName:"NewsHubResource"})))},t}(D.Component);Ge.defaultProps={handleItemClick:function e(){}},Ge.childContextTypes={preloadingSupported:U.a.bool.isRequired};var Ye=Object(re.compose)(Object(Ve.a)(1000035),ne.a,Ae.a)(Ge),Ke=n("xYG1"),Xe=M.a.createElement(De,null),Ze=function(e){function t(){return S(this,t),j(this,e.apply(this,arguments))}return R(t,e),t.prototype.shouldComponentUpdate=function e(t,n){return this.props.currentPanel!==t.currentPanel||this.props.conversationsUnseenCount!==t.conversationsUnseenCount||this.props.newsHubCount!==t.newsHubCount},t.prototype.render=function e(){var t=this.props,n=t.conversationsUnseenCount,a=t.currentPanel,r=t.handleItemClick,o=t.locale,i=t.newsHubCount,s=t.onButtonClick,c=t.siteType,l=void 0;return a===Ke.a.NEWS_HUB?l=M.a.createElement(Ye,{handleItemClick:r,locale:o,siteType:c}):a===Ke.a.INBOX&&(l=Xe),M.a.createElement("div",{className:"NewsConversationsDropdown"},M.a.createElement(Ke.b,{conversationsUnseenCount:n,newsHubCount:i,onButtonClick:s,selectedTab:a}),M.a.createElement("div",{className:"content"},l))},t}(D.Component),Je=t.default=Ze},"7IpV":function(e,t,n){"use strict";function a(e){return e===window?window.innerHeight:e.clientHeight}function r(){return void 0!==window.scrollY?window.scrollY:document.documentElement&&void 0!==document.documentElement.scrollTop?document.documentElement.scrollTop:0}function o(e){return e===window?r():e.scrollTop-e.getBoundingClientRect().top}function i(e){return e===window&&document.documentElement?document.documentElement.scrollHeight:e.scrollHeight}function s(e){return e===window?r():e.scrollTop}t.a=a,t.d=r,t.b=i,t.c=s},NYeZ:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){return l.a.createElement("img",{alt:e,className:"head",src:t})}function s(e){var t=e.viewer;return{viewerId:t.isAuth?t.id:null}}var c=n("OVW8"),l=n.n(c),u=n("DUIN"),p=n("GGB8"),d=n.n(p),m=n("IaRT"),f=n.n(m),h=3,v=[["fullWrapper"],["leftWrapper halfWrapper","rightWrapper halfWrapper isWholeHalf"],["leftWrapper halfWrapper","rightWrapper halfWrapper smallImage top","rightWrapper halfWrapper smallImage bottom"]],g=function e(t,n){var a=t.name,r=t.image_thumbnail_url;return l.a.createElement("div",{className:d()("Image","Module","boardMessageRep",n)},l.a.createElement("img",{alt:a,src:r}))},y=function e(t){function n(e){var t=e.full_name,n=e.is_default_image,a=e.image_large_url,r=e.image_medium_url,s=e.username,c=void 0===s?"":s,u=t?t[0].toUpperCase():"",p=a||r;return p&&!n?o?l.a.createElement("div",null,l.a.createElement("a",{href:"/"+c+"/"},i(t,p))):l.a.createElement("div",null,i(t,p)):l.a.createElement("div",{className:"head"},u)}var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2],o=arguments[3],s=["ConversationHead",t];return l.a.createElement("div",{className:s.join(" ")},l.a.createElement("div",{className:"contentContainer"},l.a.createElement("div",{className:"headWrapper"},l.a.createElement("div",{className:"imagesWrapper"},a.map(function(e,t){return l.a.createElement("div",{className:e,key:t},n(r[t]))})))))},E=function(e){function t(){return a(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.getUsersToShow=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=this.props.viewerId;return void 0!==a&&(n=n.filter(function(e){return e.id!==a})),n.concat(t.map(function(e){return{full_name:e}})).slice(0,3)},t.prototype.render=function e(){var t=this.props,n=t.board,a=t.emails,r=t.shouldLink,o=t.size,i=t.users,s=this.getUsersToShow(a,i),c=s.length<=3?v[s.length-1]:[];return n?g(n,o):y(o,c,s,r)},t}(c.Component);E.defaultProps={shouldLink:!1,size:"medium"},t.a=Object(u.connect)(s)(E)},RvAN:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=Object(g.b)({name:e.resourceName,options:Object.assign({page_size:e.pageSize},e.resourceOptions)})(w);return c.a.createElement(t,e)}t.a=i;var s=n("OVW8"),c=n.n(s),l=n("GGB8"),u=n.n(l),p=n("W/Cr"),d=n("IaRT"),m=n.n(d),f=n("WBZ1"),h=n.n(f),v=n("gEaE"),g=n("JKYN"),y=n("7IpV"),E={UP:"up",DOWN:"down"},b=100,w=function(e){function t(){var n,o,i;a(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=o=r(this,e.call.apply(e,[this].concat(c))),o.handleScroll=h()(function(){if(!o.props.isFetching){var e=o.props.scrollThreshold;Object(y.b)(o._container)-Object(y.c)(o._container)-Object(y.a)(o._container)<e&&o.fetchMore()}},b),o.addEventListeners=function(e){var t=o.props.useWindow;t&&(e=window),o.removeEventListeners(),e&&(t||e.addEventListener("wheel",o.preventScroll),e.addEventListener("scroll",o.handleScroll)),o._container=e},o.preventScroll=function(e){var t=e.deltaY<0?E.UP:E.DOWN,n=o._container.scrollHeight-o._container.scrollTop-o._container.clientHeight==0,a=0===o._container.scrollTop;(t===E.DOWN&&n||t===E.UP&&a)&&e.preventDefault()},i=n,r(o,i)}return o(t,e),t.prototype.componentWillReceiveProps=function e(t){var n=t.data.length;(0,t.onDataFetched)(n)},t.prototype.componentWillUnmount=function e(){this.removeEventListeners()},t.prototype.removeEventListeners=function e(){var t=this.props.useWindow;this._container&&(t||this._container.removeEventListener("wheel",this.preventScroll),this._container.removeEventListener("scroll",this.handleScroll))},t.prototype.fetchMore=function e(){this.props.isFetching||(this.props.isAtEnd?this._container.removeEventListener("scroll",this.handleScroll):this.props.fetchMoreData())},t.prototype.render=function e(){var t=this.props,n=t.className,a=t.renderEmptyState,r=t.renderItem;return this.props.isFetching||0!==this.props.data.length?c.a.createElement("div",{className:u()(n,"listContainer"),ref:this.addEventListeners},this.props.data?c.a.createElement("ul",{className:"scrollableList"},this.props.data.map(function(e,t){return r(e,t)})):null,this.props.isAtEnd?null:c.a.createElement("div",{className:"loadingItem"},c.a.createElement(v.D,{accessibilityLabel:p.a._("Loading items"),show:this.props.isFetching}))):a()},t}(s.Component);w.defaultProps={data:[],onDataFetched:function e(){},scrollThreshold:400,useWindow:!1},i.defaultProps={pageSize:10}}});